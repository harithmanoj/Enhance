name: UnitTest

on:
  pull_request:
    branches: 
      - master
      - develop
  push:
    branches:
      - master
      - develop

jobs:
  GeneralTest:
    runs-on: windows-latest

    steps:
    
    - uses: actions/checkout@v2

    - name: Enable Developer Command Prompt
      uses: ilammy/msvc-dev-cmd@v1.5.0
    
    - name: compile Timer Test Program
      working-directory: ./auto-test
      run: cl /EHsc /std:c++17 /I "..\src\Header" General.test.cpp
      
    - name: Run Test Program
      run: auto-test/General.test.exe

  ConfinedTest:
    runs-on: windows-latest

    steps:
    
    - uses: actions/checkout@v2

    - name: Enable Developer Command Prompt
      uses: ilammy/msvc-dev-cmd@v1.5.0
    
    - name: compile Timer Test Program
      working-directory: ./auto-test
      run: cl /EHsc /std:c++17 /I "..\src\Header" Confined.test.cpp
      
    - name: Run Test Program
      run: auto-test/Confined.test.exe

  ErrorTest:
    runs-on: windows-latest

    steps:
    
    - uses: actions/checkout@v2

    - name: Enable Developer Command Prompt
      uses: ilammy/msvc-dev-cmd@v1.5.0
    
    - name: compile Timer Test Program
      working-directory: ./auto-test
      run: cl /EHsc /std:c++17 /I "..\src\Header" Error.test.cpp
      
    - name: Run Test Program
      run: auto-test/Error.test.exe


  TimerTest:
    runs-on: windows-latest

    steps:
    
    - uses: actions/checkout@v2

    - name: Enable Developer Command Prompt
      uses: ilammy/msvc-dev-cmd@v1.5.0
    
    - name: compile Timer Test Program
      working-directory: ./auto-test
      run: cl /EHsc /std:c++17 /I "..\src\Header" Timer.test.cpp
      
    - name: Run Test Program
      run: auto-test/Timer.test.exe

  QueuedHandlerTest:
    runs-on: windows-latest
   
    steps:
    
    - uses: actions/checkout@v2

    - name: Enable Developer Command Prompt
      uses: ilammy/msvc-dev-cmd@v1.5.0
    
    - name: compile QueuedHandler Test Program
      working-directory: ./auto-test
      run: cl /EHsc /std:c++17 /I "..\src\Header" QueuedHandler.test.cpp
      
    - name: Run Test Program
      run: auto-test/QueuedHandler.test.exe
